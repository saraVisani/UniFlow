promotore = [(1, "Celestial Minds", "celestialminds32@libero.it"),
(2, "Radiant Minds", "radiantminds46@hotmail.com"),
(3, "Starbound", "starbound69@gmail.com"),
(4, "Aurora Labs", "auroralabs94@yahoo.it"),
(5, "Pixel Pioneers", "pixelpioneers13@hotmail.com"),
(6, "IronWolf Collective", "ironwolfcollective74@libero.it"),
(7, "IronWolf Collective", "ironwolfcollective45@hotmail.com"),
(8, "Neon Knights", "neonknights68@yahoo.it"),
(9, "QuantumLeap", "quantumleap56@yahoo.it"),
(10, "SkyBound", "skybound68@hotmail.com"),
(11, "LumenTech", "lumentech71@yahoo.it"),
(12, "Quantum Squad", "quantumsquad2@hotmail.com"),
(13, "Ignite Labs", "ignitelabs8@hotmail.com"),
(14, "Nova Titans", "novatitans64@libero.it"),
(15, "Bright Horizon", "brighthorizon11@libero.it"),
(16, "GoldenHive", "goldenhive58@yahoo.it"),
(17, "Data Mavericks", "datamavericks94@yahoo.it"),
(18, "Titan Group", "titangroup55@gmail.com"),
(19, "Skyline Dynamics", "skylinedynamics21@hotmail.com"),
(20, "Velocity Ventures", "velocityventures26@yahoo.it"),
(21, "Solaris Team", "solaristeam43@hotmail.com"),
(22, "Momentum Group", "momentumgroup40@gmail.com"),
(23, "Bright Horizon", "brighthorizon58@yahoo.it"),
(24, "Titanium Crew", "titaniumcrew33@libero.it"),
(25, "Phoenix Alliance", "phoenixalliance15@hotmail.com"),
(26, "Titan Group", "titangroup50@libero.it"),
(27, "Emerald Hive", "emeraldhive51@hotmail.com"),
(28, "Obsidian Circle", "obsidiancircle67@hotmail.com"),
(29, "Momentum Group", "momentumgroup28@hotmail.com"),
(30, "Aurora Labs", "auroralabs87@yahoo.it"),
(31, "Ignite Labs", "ignitelabs47@libero.it"),
(32, "Cosmic Collective", "cosmiccollective65@hotmail.com"),
(33, "Starbound", "starbound52@yahoo.it"),
(34, "Vortex Vision", "vortexvision4@gmail.com"),
(35, "NextGen Innovators", "nextgeninnovators39@yahoo.it"),
(36, "Pixel Pioneers", "pixelpioneers53@yahoo.it"),
(37, "Lumina Crew", "luminacrew51@hotmail.com"),
(38, "Orbis Solutions", "orbissolutions65@gmail.com"),
(39, "Nova Crew", "novacrew62@hotmail.com"),
(40, "NimbusTech", "nimbustech93@yahoo.it"),
(41, "Emerald Hive", "emeraldhive8@hotmail.com"),
(42, "SilverLine", "silverline17@hotmail.com"),
(43, "QuantumLeap", "quantumleap60@libero.it"),
(44, "Vortex Vision", "vortexvision81@hotmail.com"),
(45, "Starbound", "starbound71@libero.it"),
(46, "Alpha Nexus", "alphanexus29@yahoo.it"),
(47, "Titanium Crew", "titaniumcrew99@yahoo.it"),
(48, "Eclipse Syndicate", "eclipsesyndicate94@gmail.com"),
(49, "Radiant Minds", "radiantminds2@libero.it"),
(50, "Vanguard Labs", "vanguardlabs15@libero.it")]

collaboratori = [(5, "ZCCNTN64M06A662G"),
(7, "FRRCST02E13H223W"),
(13, "VTLGNN69P68B440X"),
(18, "NPLLND64A63L402P"),
(18, "BTAVSS01H42H266Q"),
(19, "FRNCRL07M03C365Q"),
(19, "NRENNA64B49F776Z"),
(19, "SPSTMS01T21G715H"),
(20, "LMBNCL58P20F776A"),
(20, "NREDNC60S08I123S"),
(29, "SPSTMS01T21G715H"),
(31, "FRNCRL07M03C365Q"),
(32, "TSCDNL06E23A348K"),
(32, "NREDNC60S08I123S"),
(32, "VTLGNN69P68B440X"),
(33, "NREDNC60S08I123S"),
(34, "NPLLND64A63L402P"),
(34, "FSCLNE01A51C887J"),
(35, "TSCLNZ75B02H223Z"),
(36, "FRNCRL07M03C365Q"),
(37, "FSCLNE01A51C887J"),
(39, "NRENNA64B49F776Z"),
(40, "FRRCST02E13H223W"),
(40, "NGLSFO75C52D230I"),
(40, "DNTRFL67T20C933F")]

richiesta_eventi = [(1, "Modifica", "Festival del Teatro Studentesco", 182, "Incontro di presentazione di nuove tecnologie", 33, "CRSDNL01C29G908C", "FRRRNN70T48G715L", None),
(2, "Modifica", "Conferenza Internazionale", 176, "Seminario avanzato per studenti magistrali", 43, "LMBMSM92P04B861X", "RMNDBR75S51A189M", None),
(3, "Modifica", "Workshop di Matematica", 127, "Attività seminariale di supporto alla didattica", 42, "DMCLCU91S70F205J", "TSTMNL84P12B861F", None),
(4, "Eliminazione", None, None, None, 33, None, "FRRRNN70T48G715L", None),
(5, "Modifica", "Evento di Innovazione Tecnologica", 174, "Evento di formazione continua", 40, "LRSSFN62L01C365K", "FBBLCA75B52A286A", None),
(6, "Eliminazione", None, None, None, 1, None, "ZNTDNC84L11B858F", None),
(7, "Inserimento", "Festival del Cinema Studentesco", 169, "Laboratorio interattivo a numero chiuso", None, "MZZMTT94C19B861V", None, 5),
(8, "Inserimento", "Workshop di Matematica", 117, "Evento formativo certificato", None, "DSNSRG96C16A189M", None, 10),
(9, "Inserimento", "Seminario di Storia dell'Arte", 116, "Evento aperto alla cittadinanza", None, "CNILGU97R15C792Y", None, 6),
(10, "Modifica", "Conferenza Internazionale", 143, "Evento di presentazione dei corsi di laurea", 35, "BSSNDR63C48C986R", "FSCLNE01A51C887J", None),
(11, "Eliminazione", None, None, None, 48, None, "LBRRRT97B04B207B", None),
(12, "Inserimento", "Torneo di Calcio Universitario", 147, "Incontro di presentazione di nuove tecnologie", None, "VLLDNL89E30F839G", None, "VRDPRZ04E41D111O"),
(13, "Modifica", "Torneo di Calcio Universitario", 32, "Attività seminariale di supporto alla didattica", 23, "BRBLRI58T61D111Z", "RNLVNC81S42F205Q", None),
(14, "Inserimento", "Torneo di E-Sports Universitario", 156, "Iniziativa di orientamento post-laurea", None, "PRSRCC56E69L045Y", None, "GRRGLI74E71A189I"),
(15, "Modifica", "Seminario di Letteratura Comparata", 158, "Laboratorio interattivo a numero chiuso", 1, "DNTTRS06S69A643J", "ZNTDNC84L11B858F", None),
(16, "Eliminazione", None, None, None, 36, None, "PRSGNN08R52D491D", None),
(17, "Eliminazione", None, None, None, 35, None, "FSCLNE01A51C887J", None),
(18, "Modifica", "Torneo di Sci Universitario", 78, "Seminario introduttivo per nuovi iscritti", 29, "CNIDNS80M17D433N", "RSSFNC60H25I123N", None),
(19, "Modifica", "Laboratorio di Fisica Sperimentale", 186, "Giornata di sensibilizzazione e informazione", 7, "LNGDNL79H11H266B", "NPLDNL78R10C724W", None),
(20, "Inserimento", "Torneo di Pallavolo Universitario", 99, "Attività laboratoriale guidata", None, "CVLNGL82M52A037X", None, "DLCLRA95T45I143C")]

propongono =  [(1, 25),
(1, 6),
(2, 30),
(2, 31),
(2, 20),
(3, 19),
(3, 41),
(3, 30),
(4, 37),
(5, 23),
(5, 9),
(5, 8),
(6, 2),
(6, 28),
(6, 12),
(7, 33),
(7, 30),
(7, 20),
(8, 25),
(9, 17),
(10, 47),
(10, 21),
(10, 6),
(11, 17),
(11, 31),
(12, 20),
(12, 44),
(12, 6),
(13, 41),
(13, 27),
(13, 42),
(14, 15),
(15, 37),
(15, 22),
(15, 33),
(16, 37),
(17, 7),
(17, 14),
(18, 49),
(18, 42),
(18, 2),
(19, 23),
(20, 39),
(20, 43),
(20, 28),
(21, 15),
(21, 37),
(21, 22),
(22, 13),
(22, 32),
(23, 47),
(23, 14),
(24, 39),
(25, 4),
(25, 24),
(25, 13),
(26, 25),
(26, 38),
(27, 11),
(27, 1),
(28, 12),
(28, 30),
(28, 8),
(29, 42),
(29, 20),
(29, 5),
(30, 48),
(31, 37),
(31, 2),
(31, 30),
(32, 30),
(32, 20),
(32, 46),
(33, 23),
(33, 34),
(34, 40),
(34, 50),
(35, 17),
(35, 37),
(36, 16),
(36, 31),
(37, 34),
(37, 45),
(37, 27),
(38, 27),
(38, 21),
(39, 34),
(39, 35),
(39, 46),
(40, 14),
(41, 25),
(42, 36),
(43, 34),
(43, 25),
(44, 46),
(44, 36),
(45, 36),
(45, 12),
(46, 30),
(47, 25),
(47, 8),
(48, 11),
(49, 31),
(50, 3),
(50, 49)]

import random
def promotori_per_evento(cod_evento, propongono):
    return {p[1] for p in propongono if p[0] == cod_evento}


def collaboratori_per_evento(cod_evento, collaboratori):
    return {c[1] for c in collaboratori if c[0] == cod_evento}
def aggiungi_collaboratori(richieste, collaboratori, max_op=3):
    valide = [r for r in richieste if r[1] in ("Modifica", "Inserimento") and r[5] is not None]
    random.shuffle(valide)

    count = 0
    for r in valide:
        if count >= max_op:
            break

        cod_richiesta = r[0]
        cod_evento = r[5]

        coll_attuali = collaboratori_per_evento(cod_evento, collaboratori)
        possibili = [c[1] for c in collaboratori if c[1] not in coll_attuali]

        if not possibili:
            continue

        cf = random.choice(possibili)

        print(f'insert into Agg_Collaboratore values ({cod_richiesta}, "{cf}");')
        count += 1
def aggiungi_promotori(richieste, promotori, propongono, max_op=3):
    valide = [r for r in richieste if r[1] in ("Modifica", "Inserimento") and r[5] is not None]
    random.shuffle(valide)

    count = 0
    for r in valide:
        if count >= max_op:
            break

        cod_richiesta = r[0]
        cod_evento = r[5]

        attuali = promotori_per_evento(cod_evento, propongono)
        possibili = [p[0] for p in promotori if p[0] not in attuali]

        if not possibili:
            continue

        cod_prom = random.choice(possibili)

        print(f'insert into Agg_Promotore values ({cod_prom}, {cod_richiesta});')
        count += 1
def elimina_collaboratori(richieste, collaboratori, max_op=3):
    valide = [r for r in richieste if r[1] == "Modifica" and r[5] is not None]
    random.shuffle(valide)

    count = 0
    for r in valide:
        if count >= max_op:
            break

        cod_richiesta = r[0]
        cod_evento = r[5]

        coll_attuali = collaboratori_per_evento(cod_evento, collaboratori)

        if not coll_attuali:
            continue

        cf = random.choice(list(coll_attuali))

        print(f'insert into Elim_Collaboratore values ({cod_richiesta}, "{cf}");')
        count += 1
def elimina_promotori(richieste, propongono, max_op=3):
    valide = [r for r in richieste if r[1] == "Modifica" and r[5] is not None]
    random.shuffle(valide)

    count = 0
    for r in valide:
        if count >= max_op:
            break

        cod_richiesta = r[0]
        cod_evento = r[5]

        promotori = list(promotori_per_evento(cod_evento, propongono))

        if len(promotori) < 2:
            continue

        cod_prom = random.choice(promotori)

        print(f'insert into Elim_Promotore values ({cod_prom}, {cod_richiesta});')
        count += 1
aggiungi_collaboratori(richiesta_eventi, collaboratori)
aggiungi_promotori(richiesta_eventi, promotore, propongono)

elimina_collaboratori(richiesta_eventi, collaboratori)
elimina_promotori(richiesta_eventi, propongono)
